.\" Automatically generated by Pod::Man 2.23 (Pod::Simple 3.13)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "rhostck 1"
.TH rhostck 1 " " "" ""
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
rhostck \- tell rblsmtpd to block mails from hosts with suspicious names
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fBrhostck rblsmtpd\fR ...
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
\&\fBrhostck\fR is supposed to run under \fB\f(BItcpserver\fB\|(1)\fR and to execute
\&\fB\f(BIrblsmtpd\fB\|(1)\fR.
.PP
\&\fBrhostck\fR checks the \f(CW$TCPREMOTEHOST\fR environment variable. Based on
the name of the remote host \fBrhostck\fR may decide to set the \f(CW$RBLSMTPD\fR
environment variable in order to tell \fBrblsmtpd\fR to reject the incoming
\&\s-1SMTP\s0 delivery request. By default \fBrhostck\fR instructs \fBrblsmtpd\fR to
reject remote hosts without a hostname.
.PP
In the environment variable \f(CW$RHOSTCK_DENYPARTS\fR a space separated list
of name parts of a hostname can be defined, that typically occur in
hostnames of dynamic lines. \fBrhostck\fR splits the remote hostname at the
dots and looks at each part in front of the penultimate dot. \f(CW$RBLSMTPD\fR
will be set with an error message, if at least one such part exists and
starts with one of the parts given in \f(CW$RHOSTCK_DENYPARTS\fR.
.PP
If the environment variable \f(CW$RHOSTCK_IPHOSTNAME\fR is filled with a valid
value, the part of remote hostname in front of the penultimate dot is
checked to contain the remote host's ip address (or part of it). Valid
values are \f(CW2\fR, \f(CW3\fR and \f(CW4\fR, which defines the number of bytes from the
binary \s-1IP\s0 address from \s-1LSB\s0 to \s-1MSB\s0 (or numbers of the dot-decimal notation
from right to left) to be used for comparing. The (partial) \s-1IP\s0 address is
searched in the hostname in decimal and hexdecimal form; the numbers may
be separated by dots or hyphens, or without separators for decimal numbers
each number is expected to be three bytes long and left-zero-padded,
whereas the hexadecimal form uses the usual two nibbles for a byte.
All comparisons are also done in reverse order. If the (partial) remote \s-1IP\s0
address is found in the remote hostname in any form described above,
\&\f(CW$RBLSMTPD\fR will be set with an error message.
.PP
The error message for \fBrblsmtpd\fR is taken from the content of
\&\f(CW$RHOSTCK_DENYMSG\fR. If this is not set or emtpy the default text is
\&\f(CW"\-Suspicious hostname \- I don\*(Aqt accept mails from hosts on dynamic IP addresses."\fR;
it starts with a hyphen to instruct \fBrblsmtpd\fR to terminate the
connection with a 553 permanent error.
Eventually \fBrhostck\fR executes the command given as its first argument,
which is \fBrblsmtpd\fR normally.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fItcpserver\fR\|(1), \fIrblsmtpd\fR\|(1)
.PP
http://cr.yp.to/ucspi\-tcp.html <http://cr.yp.to/ucspi-tcp.html>
